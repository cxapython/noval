# 快速开始指南

## 🚀 一键启动（推荐）

### Linux / macOS 用户

```bash
./start.sh
```

就是这么简单！脚本会自动完成以下所有准备工作：

### ✅ 自动化功能清单

1. **检测并安装 uv**
   - 如果未安装，自动下载安装
   - 配置环境变量

2. **检测并安装 Node.js / npm**
   - 检测版本是否符合要求（Node >= 16）
   - macOS：使用 Homebrew 安装
   - Linux：使用 apt 安装

3. **创建目录结构**
   - 自动创建 logs、data、configs 等必要目录

4. **配置文件检查**
   - 从示例文件复制配置模板（如果不存在）

5. **Python 虚拟环境**
   - 使用 uv 创建和管理虚拟环境
   - 自动修复损坏的虚拟环境

6. **安装 Python 依赖**
   - 自动安装 requirements.txt 中的所有依赖

7. **Playwright 浏览器**
   - 自动安装 Playwright 和 Chromium 浏览器
   - 在 Linux 上自动安装系统依赖

8. **前端依赖**
   - 自动执行 npm install
   - 智能检测依赖是否需要更新

9. **数据库初始化**
   - 自动创建所有数据表
   - 创建默认管理员账户

10. **启动服务**
    - 后端 API 服务（端口 5001）
    - 前端界面（自动分配端口）

## 📋 首次使用步骤

### 1. 克隆项目

```bash
git clone <repository-url>
cd noval
```

### 2. 配置数据库（可选）

如果你需要使用 MySQL 数据库：

```bash
# 复制配置文件
cp shared/utils/config.example.py shared/utils/config.py

# 编辑配置文件
vim shared/utils/config.py
```

修改数据库连接信息：
```python
DB_CONFIG = {
    'host': 'localhost',
    'port': 3306,
    'user': 'your_user',
    'password': 'your_password',
    'database': 'novel_db'
}
```

### 3. 一键启动

```bash
./start.sh
```

首次运行可能需要 5-10 分钟，因为需要下载和安装所有依赖。

### 4. 访问系统

启动完成后，终端会显示访问地址：

```
📋 访问地址：
   前端界面: http://localhost:3000
   后端API:  http://localhost:5001

🧪 功能页面：
   配置向导: http://localhost:3000/
   爬虫管理: http://localhost:3000/crawler
   小说阅读: http://localhost:3000/reader
```

### 5. 停止服务

```bash
./stop.sh
```

## ⚠️ 常见问题

### 1. uv 安装失败

如果自动安装失败，请手动安装：

```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
source ~/.bashrc  # 或 source ~/.zshrc
```

### 2. Node.js 版本过低

在 macOS 上：
```bash
brew install node
```

在 Linux 上：
```bash
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt-get install -y nodejs
```

或使用 nvm：
```bash
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
nvm install 20
nvm use 20
```

### 3. Playwright 浏览器问题

如果浏览器启动失败，手动运行：

```bash
./install-playwright-server.sh
```

### 4. 数据库连接失败

检查以下内容：
- MySQL 服务是否启动
- 配置文件 `shared/utils/config.py` 是否正确
- 数据库用户权限是否足够

### 5. 端口占用

如果端口被占用，可以：
- 修改 `backend/api.py` 中的后端端口
- Vite 前端会自动选择可用端口

## 🎯 系统要求

### 最低要求

- **操作系统**: Linux / macOS
- **Python**: 3.8+
- **Node.js**: 16+
- **内存**: 2GB+
- **磁盘**: 1GB+

### 推荐配置

- **操作系统**: Ubuntu 20.04+ / macOS 12+
- **Python**: 3.10+
- **Node.js**: 18+
- **内存**: 4GB+
- **磁盘**: 5GB+

## 📚 下一步

1. **阅读文档**
   - [功能说明](./功能说明.md)
   - [V5 使用指南](./V5_使用指南.md)
   - [项目说明](./项目说明.md)

2. **配置爬虫**
   - 使用可视化向导创建爬虫配置
   - 或编辑 `configs/` 目录下的 JSON 配置文件

3. **开始爬取**
   - 在爬虫管理页面启动任务
   - 实时查看爬取进度

4. **阅读小说**
   - 在小说阅读器中浏览已爬取的内容
   - 自定义阅读体验

## 💡 开发模式

如果你想进行开发或调试：

### 分别启动服务

```bash
# 后端（终端1）
.venv/bin/python backend/api.py

# 前端（终端2）
cd frontend
npm run dev
```

### 查看日志

```bash
# 实时查看后端日志
tail -f logs/backend.log

# 实时查看前端日志
tail -f logs/frontend.log
```

### 清理环境

```bash
# 删除虚拟环境
rm -rf .venv

# 删除前端依赖
rm -rf frontend/node_modules

# 重新初始化
./start.sh
```

## 🔧 手动安装（不推荐）

如果你更喜欢手动控制每个步骤：

```bash
# 1. 安装 uv
curl -LsSf https://astral.sh/uv/install.sh | sh

# 2. 创建虚拟环境
uv venv .venv

# 3. 安装 Python 依赖
uv pip install -r requirements.txt

# 4. 安装 Playwright
.venv/bin/python -m playwright install chromium

# 5. 安装前端依赖
cd frontend
npm install
cd ..

# 6. 初始化数据库
.venv/bin/python scripts/init_reader_tables.py
.venv/bin/python scripts/init_auth_tables.py

# 7. 启动服务
./start.sh
```

## 🆘 获取帮助

如果遇到问题：

1. 查看日志文件：`logs/backend.log` 和 `logs/frontend.log`
2. 检查配置文件：`shared/utils/config.py`
3. 查看文档目录：`docs/`
4. 提交 Issue 到项目仓库

---

**祝使用愉快！** 🎉

